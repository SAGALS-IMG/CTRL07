unit unit_option;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ComCtrls, Vcl.StdCtrls, IniFiles;

type
  TForm_Option = class(TForm)
    StatusBar1: TStatusBar;
    GroupBox1: TGroupBox;
    GroupBox2: TGroupBox;
    GroupBox3: TGroupBox;
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
  private
    { Private êÈåæ }
  public
    { Public êÈåæ }
  end;

var
  Form_Option: TForm_Option;

implementation

{$R *.dfm}

procedure TForm_Option.FormCreate(Sender: TObject);
var
  Ini: TIniFile;
begin
  Ini := TIniFile.Create( ChangeFileExt( Application.ExeName, '.INI' ) );
  try
    Top     := Ini.ReadInteger( 'Form_Opt', 'Top', 100 );
    Left    := Ini.ReadInteger( 'Form_Opt', 'Left', 100 );
    if Ini.ReadBool( 'Form_Opt', 'InitMax', false ) then
      WindowState := wsMaximized
    else
      WindowState := wsNormal;

  finally
    Ini.Free;
  end;
end;

procedure TForm_Option.FormDestroy(Sender: TObject);
var
  Ini: TIniFile;
begin
  Ini := TIniFile.Create( ChangeFileExt( Application.ExeName, '.INI' ) );
  try
    Ini.WriteInteger( 'Form_Opt', 'Top', Top);
    Ini.WriteInteger( 'Form_Opt', 'Left', Left);
    Ini.WriteBool( 'Form_Opt', 'InitMax', WindowState = wsMaximized );

  finally
    Ini.Free;
  end;
end;

end.
